@page "/"
@inject IHttpClientFactory HttpClientFactory
@using Generador.FrontEnd.Models
@using static System.Net.WebRequestMethods


<h3>Prueba de conección a la API</h3>

@if (personajes == null){
    <p><em>..Cargando Datos</em></p>
}
else {
    <p>¡Datos cargados correctamente!</p>
    <ul>
        @foreach (var cuerpo in personajes.Cuerpos)
        {
            <li>Cuerpo: @cuerpo.Nombre</li>
        }
    </ul>
}

@code{
    private PersonajesDto? personajes;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            var client = HttpClientFactory.CreateClient("Generador de poses");
            personajes = await client.GetFromJsonAsync<PersonajesDto>("api/personajes");
            
        }
        catch(Exception ex)
        {
            Console.WriteLine($"Error al cargar los datos: {ex.Message}");
        }
    }
}